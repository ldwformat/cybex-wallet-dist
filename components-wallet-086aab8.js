(window.webpackJsonp=window.webpackJsonp||[]).push([[278],{248:function(e,t,n){"use strict";n.r(t),n.d(t,"WalletCreate",function(){return C}),n.d(t,"CreateWalletFromBrainkey",function(){return O});var a=n(0),r=n(2),l=n(985),o=n(1),s=n.n(o),c=n(257),i=n(258),u=n(10),p=n(44),m=n(43),d=n(17),h=n(20),f=n(57),b=n(8),_=n.n(b),y=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=((k=function(e){function t(e){v(this,t);var n=w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={wallet_public_name:"default",valid_password:null,errors:{validBrainkey:!1},isValid:!1,create_submitted:!1,custom_brainkey:e.restoreBrainkey||!1,brnkey:null},n.validate=n.validate.bind(n),n}return E(t,a["Component"]),y(t,[{key:"onBack",value:function(e){e.preventDefault(),window.history.back()}},{key:"onPassword",value:function(e){this.state.valid_password=e,this.setState({valid_password:e},this.validate)}},{key:"onCustomBrainkey",value:function(){this.setState({custom_brainkey:!0})}},{key:"onBrainkey",value:function(e){this.state.brnkey=e,this.setState({brnkey:e},this.validate)}},{key:"onSubmit",value:function(e){e.preventDefault();var t=this.state,n=t.wallet_public_name,a=t.valid_password,r=t.custom_brainkey,l=t.errors;!a||l.wallet_public_name||r&&!l.validBrainkey||(m.a.setWallet(n,a,this.state.brnkey),h.a.changeSetting({setting:"passwordLogin",value:!1}),this.setState({create_submitted:!0}))}},{key:"formChange",value:function(e){var t=e.target.id,n=e.target.value;"wallet_public_name"===t&&(n=n.toLowerCase(),/[^a-z0-9_-]/.test(n))||(this.state[t]=n,this.setState(this.state),this.validate())}},{key:"validate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,t=e.errors,n=this.props.wallet_names;t.wallet_public_name=n.has(e.wallet_public_name)?"Wallet "+e.wallet_public_name.toUpperCase()+" exists, please change the name":null;var a=null===t.wallet_public_name&&null!==e.valid_password;e.custom_brainkey&&a&&(a=null!==e.brnkey),this.setState({isValid:a,errors:t})}},{key:"render",value:function(){var e=this,t=this.state.errors,n=!!this.props.current_wallet;return this.state.create_submitted&&this.state.wallet_public_name===this.props.current_wallet?a.createElement("div",{className:"text-center",style:{maxWidth:"40rem",margin:"auto"}},a.createElement("h4",null,a.createElement(s.a,{content:"wallet.wallet_created"})),a.createElement(l.a,{to:"/dashboard"},a.createElement("div",{className:"button success"},a.createElement(s.a,{content:"wallet.done"})))):a.createElement("form",{style:{maxWidth:"40rem",margin:"auto"},onSubmit:this.onSubmit.bind(this),onChange:this.formChange.bind(this),noValidate:!0},a.createElement("div",{className:"grid-content",style:{textAlign:"left"}},this.props.restoreBrainkey?null:a.createElement(s.a,{component:"p",content:"wallet.create_importkeys_text"}),this.props.restoreBrainkey?null:a.createElement(s.a,{component:"p",content:"wallet.create_text"})),a.createElement(i.a,{onValid:this.onPassword.bind(this)}),n?a.createElement("div",{className:"no-overflow"},a.createElement("br",null),a.createElement("section",null,a.createElement("label",null,a.createElement(s.a,{content:"wallet.name"})),a.createElement("input",{tabIndex:3,type:"text",id:"wallet_public_name",defaultValue:this.state.wallet_public_name})),a.createElement("div",{className:"has-error"},t.wallet_public_name),a.createElement("br",null)):null,a.createElement("div",{className:"no-overflow"},this.state.custom_brainkey?a.createElement("div",null,a.createElement("label",null,a.createElement(s.a,{content:"wallet.brainkey"})),a.createElement(c.a,{tabIndex:4,onChange:this.onBrainkey.bind(this),errorCallback:function(t){var n=e.state.errors;n.validBrainkey=t,e.setState({errors:n})}})):null,a.createElement(f.g,{type:"primary",size:"small",disabled:!this.state.isValid,style:{marginRight:"1em"}},_.a.translate("wallet.create_wallet")),a.createElement(f.g,{type:"secondary",size:"small",onClick:this.onBack.bind(this)},_.a.translate("wallet.cancel"))),this.state.custom_brainkey?null:a.createElement("div",{style:{paddingTop:20}},a.createElement("label",null,a.createElement("a",{onClick:this.onCustomBrainkey.bind(this)},a.createElement(s.a,{content:"wallet.custom_brainkey"})))))}}]),t}()).propTypes={hideTitle:r.bool},k);g=Object(d.connect)(g,{listenTo:function(){return[p.a]},getProps:function(){return p.a.getState()}});var k,C=function(e){function t(){return v(this,t),w(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return E(t,a["Component"]),y(t,[{key:"render",value:function(){return u.a.getWallet()&&this.props.children?a.createElement("div",null,this.props.children):a.createElement(g,Object.assign({},this.props))}}]),t}(),O=function(e){return e.nested?a.createElement(C,Object.assign({restoreBrainkey:!0},e)):a.createElement("div",{className:"grid-container",style:{paddingTop:30,textAlign:"center"}},a.createElement("div",{className:"wrapper readable",style:{display:"inline-block",margin:"auto"}},a.createElement(s.a,{content:"settings.backup_brainkey",component:"h3"}),a.createElement(s.a,{content:"settings.restore_brainkey_text",component:"p",style:{maxWidth:"40rem",paddingBottom:10}}),a.createElement(C,Object.assign({restoreBrainkey:!0},e))))}},257:function(e,t,n){"use strict";var a,r=n(0),l=n.n(r),o=n(24),s=n.n(o),c=n(3),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var d=function(e){function t(){u(this,t);var e=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={brnkey:"",loading:!0},e}return m(t,l.a.Component),i(t,[{key:"componentWillMount",value:function(){var e=this;n.e(241).then(n.t.bind(null,838,7)).then(function(t){console.debug("Result: ",t),a=new Set(t.en.split(",")),e.setState({loading:!1})})}},{key:"_checkBrainKey",value:function(){var e=[];this.state.brnkey.split(" ").forEach(function(t,n){if(""!==t){var r=t.toLowerCase();null===(r=r.match(/[a-z]+/))||a.has(r[0])?e.push(l.a.createElement("span",{key:n,style:{padding:"1px",margin:"1px"}},t)):e.push(l.a.createElement(h,{key:n},t))}});var t=void 0,n=!0,r=!0;return e.length>0&&(this.state.brnkey.length<50?(t=this.state.brnkey.length+" characters (50 minimum)",r=!1):e.length<16?t=e.length+" words (16 recommended)":(t=e.length+" words",n=!1)),{warn:n,valid:r,word_count_label:t,checked_words:e}}},{key:"render",value:function(){if(this.state.loading||!a)return l.a.createElement("div",{style:{padding:20}},"Fetching dictionary....");var e=this._checkBrainKey(),t=e.warn,n=e.word_count_label,r=e.checked_words;return l.a.createElement("span",{className:""},l.a.createElement("div",null,l.a.createElement("textarea",{tabIndex:this.props.tabIndex||1,onChange:this.formChange.bind(this),value:this.state.brnkey,id:"brnkey",style:{height:100,minWidth:450}}),l.a.createElement("div",{style:{textAlign:"left"},className:"grid-content no-padding no-overflow"},r),this.state.check_digits&&!this.props.hideCheckDigits?l.a.createElement("div",null,l.a.createElement("br",null),l.a.createElement("pre",{className:"no-overflow"},this.state.check_digits," * Check Digits"),l.a.createElement("br",null)):null,l.a.createElement("p",null,l.a.createElement("i",{className:s()({error:t})},n))))}},{key:"formChange",value:function(e){var t=e.target,n=t.id,a=t.value,r=this._checkBrainKey().valid,l={};if(l[n]=a,"brnkey"===n){var o=c.o.normalize_brainKey(a);this.props.onChange(o.length<50?null:o),l.check_digits=o.length<50?null:c.n.sha1(o).toString("hex").substring(0,4)}this.setState(l),this.props.errorCallback&&this.props.errorCallback(r)}}]),t}();d.propTypes={onChange:r.PropTypes.func.isRequired},t.a=d;var h=function(e){function t(){return u(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,l.a.Component),i(t,[{key:"render",value:function(){return l.a.createElement("span",{style:{borderBottom:"1px dotted #ff0000",padding:"1px",margin:"1px"}},l.a.createElement("span",{style:{borderBottom:"1px dotted #ff0000"}},this.props.children))}}]),t}()},258:function(e,t,n){"use strict";var a=n(0),r=n.n(a),l=n(1),o=n.n(l),s=n(5),c=n.n(s),i=n(24),u=n.n(i),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var m=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={password:"",confirm:"",errors:c.a.Map(),valid:!1},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),p(t,[{key:"componentDidMount",value:function(){this.refs.firstPassword&&this.refs.firstPassword.focus()}},{key:"render",value:function(){var e=this.state,t=(e.password,e.confirm,e.valid,e.errors),n=this.props.newPassword,a=1;return r.a.createElement("div",{className:u()({"has-error":t.size})},r.a.createElement(o.a,{component:"label",content:n?"wallet.new_password":"wallet.password"}),r.a.createElement("section",null,r.a.createElement("input",{className:"full",type:"password",id:"password",ref:"firstPassword",onChange:this.formChange.bind(this),value:this.state.password,tabIndex:a++})),r.a.createElement(o.a,{component:"label",content:n?"wallet.new_confirm":"wallet.confirm"}),r.a.createElement("section",null,r.a.createElement("input",{className:"full",type:"password",id:"confirm",onChange:this.formChange.bind(this),value:this.state.confirm,tabIndex:a++})),r.a.createElement("div",{style:{paddingBottom:10}},t.get("password_match")||t.get("password_length")),this.props.children,r.a.createElement("br",null))}},{key:"formChange",value:function(e){var t=this.state;t[e.target.id]=e.target.value,this.setState(t),this.validate(t)}},{key:"validate",value:function(e){var t=e.password,n=e.confirm;n=n.trim(),t=t.trim();var a=c.a.Map();0!==t.length&&t.length<8&&(a=a.set("password_length","Password must be 8 characters or more")),""!==t&&""!==n&&t!==n&&(a=a.set("password_match","Passwords do not match"));var r=t.length>=8&&t===n;this.setState({errors:a,valid:r}),this.props.onValid(r?t:null)}}]),t}();m.propTypes={onValid:a.PropTypes.func.isRequired},t.a=m},343:function(e,t,n){"use strict";n.d(t,"a",function(){return W}),n.d(t,"b",function(){return B});var a=n(0),r=n.n(a),l=n(985),o=n(63),s=n(17),c=n(43),i=n(40),u=n(44),p=n(266),m=n(26),d=n(10),h=n(65),f=n(34),b=n(342),_=n(24),y=n.n(_),v=n(1),w=n.n(v),E=(n(4),n(3)),g=n(20),k=n(557),C=n(1503),O=n(984),S=n(357),j=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var T={listenTo:function(){return[u.a,p.a,m.a]},getProps:function(){return{wallet:u.a.getState(),backup:p.a.getState()}}},W=function(e){function t(){return N(this,t),P(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return x(t,r.a.Component),j(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"readable"},r.a.createElement(R,{noText:this.props.noText,newAccount:this.props.location?this.props.location.query.newAccount:null},r.a.createElement(K,null),this.props.noText?null:r.a.createElement(V,null),r.a.createElement(D,{downloadCb:this.props.downloadCb})))}}]),t}();W=Object(s.connect)(W,T);var B=function(e){function t(){N(this,t);var e=P(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={newWalletName:null},e}return x(t,r.a.Component),j(t,[{key:"componentWillMount",value:function(){h.c.reset()}},{key:"render",value:function(){var e=this.props.wallet.new_wallet;this.props.wallet.wallet_names.has(e);return r.a.createElement("div",null,r.a.createElement(w.a,{component:"p",content:"wallet.import_backup_choose"}),(new FileReader).readAsBinaryString?null:r.a.createElement("p",{className:"error"},"Warning! You browser doesn't support some some file operations required to restore backup, we recommend you to use Chrome or Firefox browsers to restore your backup."),r.a.createElement(L,null,r.a.createElement(K,null),r.a.createElement(M,{saveWalletObject:!0},r.a.createElement(I,null,r.a.createElement(A,null)))))}}]),t}();B=Object(s.connect)(B,T);var A=function(e){function t(){N(this,t);var e=P(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={},e}return x(t,r.a.Component),j(t,[{key:"isRestored",value:function(){var e=this.props.wallet.new_wallet;return this.props.wallet.wallet_names.has(e)}},{key:"render",value:function(){var e=this.props.wallet.new_wallet;return this.isRestored()?r.a.createElement("span",null,r.a.createElement("h5",null,r.a.createElement(w.a,{content:"wallet.restore_success",name:e.toUpperCase()})),r.a.createElement(l.a,{to:"/dashboard"},r.a.createElement("div",{className:"button outline"},r.a.createElement(w.a,{component:"span",content:"header.dashboard"}))),r.a.createElement("div",null,this.props.children)):r.a.createElement("span",null,r.a.createElement("h3",null,r.a.createElement(w.a,{content:"wallet.ready_to_restore"})),r.a.createElement("div",{className:"button outline",onClick:this.onRestore.bind(this)},r.a.createElement(w.a,{content:"wallet.restore_wallet_of",name:e})))}},{key:"onRestore",value:function(){c.a.restore(this.props.wallet.new_wallet,this.props.backup.wallet_object),g.a.changeSetting({setting:"passwordLogin",value:!1})}}]),t}();A=Object(s.connect)(A,T);var I=function(e){function t(){N(this,t);var e=P(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={new_wallet:null,accept:!1},e}return x(t,r.a.Component),j(t,[{key:"componentWillMount",value:function(){var e=!!this.props.wallet.current_wallet;if(!e){var t="default";this.props.backup.name&&(t=this.props.backup.name.match(/[a-zA-Z0-9_-]*/)[0]),u.a.setNewWallet(t),this.setState({accept:!0})}if(e&&this.props.backup.name&&!this.state.new_wallet){var n=this.props.backup.name.match(/[a-z0-9_-]*/)[0];n&&this.setState({new_wallet:n})}}},{key:"render",value:function(){if(this.state.accept)return r.a.createElement("span",null,this.props.children);var e=!!this.state.new_wallet,t=!!e&&this.props.wallet.wallet_names.has(this.state.new_wallet),n=!t&&e;return r.a.createElement("form",{onSubmit:this.onAccept.bind(this)},r.a.createElement("h5",null,r.a.createElement(w.a,{content:"wallet.new_wallet_name"})),r.a.createElement("input",{type:"text",id:"new_wallet",onChange:this.formChange.bind(this),value:this.state.new_wallet}),r.a.createElement("p",null,t?r.a.createElement(w.a,{content:"wallet.wallet_exist"}):null),r.a.createElement("div",{onClick:this.onAccept.bind(this),type:"submit",className:y()("button outline",{disabled:!n})},r.a.createElement(w.a,{content:"wallet.accept"})))}},{key:"onAccept",value:function(e){e&&e.preventDefault(),this.setState({accept:!0}),u.a.setNewWallet(this.state.new_wallet)}},{key:"formChange",value:function(e){var t=e.target.id,n=e.target.value;if("new_wallet"!==t||(n=n.toLowerCase(),!/[^a-z0-9_-]/.test(n))){var a={};a[t]=n,this.setState(a)}}}]),t}();I=Object(s.connect)(I,T);var D=function(e){function t(){return N(this,t),P(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return x(t,r.a.Component),j(t,[{key:"componentWillMount",value:function(){try{this.isFileSaverSupported=!!new Blob}catch(e){}}},{key:"componentDidMount",value:function(){this.isFileSaverSupported||f.b.error("File saving is not supported")}},{key:"render",value:function(){return r.a.createElement("div",{className:"button",onClick:this.onDownload.bind(this)},r.a.createElement(w.a,{content:"wallet.download"}))}},{key:"onDownload",value:function(){var e=new Blob([this.props.backup.contents],{type:"application/octet-stream; charset=us-ascii"});if(e.size!==this.props.backup.size)throw new Error("Invalid backup to download conversion");Object(b.saveAs)(e,this.props.backup.name),c.a.setBackupDate(),this.props.downloadCb&&this.props.downloadCb()}}]),t}();D=Object(s.connect)(D,T);var R=function(e){function t(e){N(this,t);var n=P(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.resetWallet=function(){d.a.resetBrainKeySequence().then(function(){i.a.lock(),i.a.unlock().then(function(){h.c.updateMyAccounts(),n.setState({afterReset:!0})})})},n.refreshWallet=function(){h.c.updateMyAccounts(),n.setState({step:1})},n.reload=function(){location.reload()},n.state={step:0,afterReset:!1},n}return x(t,r.a.Component),j(t,[{key:"getBackupName",value:function(){var e=this.props.wallet.current_wallet;0!==e.indexOf("Cybex")&&(e="Cybex_"+e);var t=new Date,n=t.getMonth()+1,a=t.getDate();return e=e+"_"+t.getFullYear()+(n>=10?n:"0"+n)+(a>=10?a:"0"+a)+".bin"}},{key:"render",value:function(){if(!!this.props.backup.contents)return r.a.createElement("div",null,this.props.children);var e=null!=d.a.getWallet(),t=this.props.backup.myAccounts;return r.a.createElement("div",null,this.props.noText?null:r.a.createElement("div",{style:{textAlign:"left"}},this.props.newAccount?r.a.createElement(w.a,{component:"p",content:"wallet.backup_new_account"}):null,r.a.createElement(w.a,{component:"p",content:"wallet.backup_explain"})),0===this.state.step&&r.a.createElement(w.a,{component:"p",content:"wallet.backup_refresh"}),0===this.state.step&&r.a.createElement(w.a,{className:"button",content:"wallet.backup_check",onClick:this.refreshWallet}),1===this.state.step&&r.a.createElement(w.a,{component:"p",content:"wallet.backup_accounts"}),1===this.state.step&&r.a.createElement("table",{className:"table table-backup"},r.a.createElement("tr",null,r.a.createElement(w.a,{component:"th",content:"account.name"}),r.a.createElement(w.a,{component:"th",content:"wallet.account_state"})),t.map(function(e){return r.a.createElement("tr",{key:e.account_name},r.a.createElement("td",{className:"text-center"},e.account_name),r.a.createElement("td",{className:"text-center"},e.auth))})),1===this.state.step&&r.a.createElement("section",null,r.a.createElement(w.a,{component:"p",content:"wallet.need_reset"}),r.a.createElement("button",{onClick:this.onCreateBackup.bind(this),className:y()("button",{disabled:!e||this.state.afterReset})},r.a.createElement(w.a,{content:"wallet.create_backup_of",name:this.props.wallet.current_wallet})),this.state.afterReset?r.a.createElement(k.a,{timeToCount:20,onClick:this.reload},r.a.createElement(w.a,{content:"logout.reload"})):r.a.createElement(w.a,{className:"button",onClick:this.resetWallet,content:"wallet.brainkey_seq_reset_button"})),r.a.createElement(z,null))}},{key:"onCreateBackup",value:function(){var e=this,t=d.a.getWallet().password_pubkey;Object(h.a)(t).then(function(t){var n=e.getBackupName();h.c.incommingBuffer({name:n,contents:t})})}}]),t}();R=Object(s.connect)(R,T);var z=function(e){function t(){return N(this,t),P(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return x(t,r.a.Component),j(t,[{key:"render",value:function(){if(!d.a.getWallet())return null;var e=d.a.getWallet().backup_date,t=d.a.getWallet().last_modified,n=e?r.a.createElement("h4",null,r.a.createElement(w.a,{content:"wallet.last_backup"})," ",r.a.createElement(o.a,{value:e})):r.a.createElement(w.a,{style:{paddingTop:20},className:"facolor-error",component:"p",content:"wallet.never_backed_up"}),a=null;return e&&(a=t.getTime()>e.getTime()?r.a.createElement("h4",{className:"facolor-error"},r.a.createElement(w.a,{content:"wallet.need_backup"})):r.a.createElement("h4",{className:"success"},r.a.createElement(w.a,{content:"wallet.noneed_backup"}))),r.a.createElement("span",null,n,a)}}]),t}(),L=function(e){function t(){return N(this,t),P(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return x(t,r.a.Component),j(t,[{key:"reset",value:function(){h.c.reset()}},{key:"render",value:function(){var e=r.a.createElement("div",{style:{paddingTop:20}},r.a.createElement("div",{onClick:this.reset.bind(this),className:y()("button outline",{disabled:!this.props.backup.contents})},r.a.createElement(w.a,{content:"wallet.reset"})));if(this.props.backup.contents&&this.props.backup.public_key)return r.a.createElement("span",null,this.props.children,e);var t=this.props.backup.contents&&!this.props.backup.public_key;return r.a.createElement("div",null,r.a.createElement("input",{ref:"file_input",accept:".bin",type:"file",id:"backup_input_file",style:{border:"solid"},onChange:this.onFileUpload.bind(this)}),t?r.a.createElement("h5",null,r.a.createElement(w.a,{content:"wallet.invalid_format"})):null,e)}},{key:"onFileUpload",value:function(e){var t=e.target.files[0];h.c.incommingWebFile(t),this.forceUpdate()}}]),t}();L=Object(s.connect)(L,T);var K=function(e){function t(){return N(this,t),P(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return x(t,r.a.Component),j(t,[{key:"render",value:function(){return r.a.createElement("span",null,r.a.createElement("h5",null,r.a.createElement("b",null,this.props.backup.name)," (",this.props.backup.size," bytes)"),this.props.backup.last_modified?r.a.createElement("div",null,this.props.backup.last_modified):null,r.a.createElement("br",null))}}]),t}();K=Object(s.connect)(K,T);var M=function(e){function t(){N(this,t);var e=P(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state=e._getInitialState(),e}return x(t,r.a.Component),j(t,[{key:"_getInitialState",value:function(){return{backup_password:"",verified:!1}}},{key:"render",value:function(){return this.state.verified?r.a.createElement("span",null,this.props.children):r.a.createElement("form",{onSubmit:this.onPassword.bind(this)},r.a.createElement("label",null,r.a.createElement(w.a,{content:"wallet.enter_password"})),r.a.createElement("input",{type:"password",id:"backup_password",onChange:this.formChange.bind(this),value:this.state.backup_password}),r.a.createElement(V,null),r.a.createElement("div",{type:"submit",className:"button outline",onClick:this.onPassword.bind(this)},r.a.createElement(w.a,{content:"wallet.submit"})))}},{key:"onPassword",value:function(e){var t=this;e&&e.preventDefault();var n=E.h.fromSeed(this.state.backup_password||""),a=this.props.backup.contents;Object(h.b)(n.toWif(),a).then(function(e){t.setState({verified:!0}),t.props.saveWalletObject&&p.a.setWalletObjct(e)}).catch(function(e){console.error("Error verifying wallet "+t.props.backup.name,e,e.stack),"invalid_decryption_key"===e?f.b.error("Invalid Password"):f.b.error(""+e)})}},{key:"formChange",value:function(e){var t={};t[e.target.id]=e.target.value,this.setState(t)}}]),t}();M.propTypes={saveWalletObject:a.PropTypes.bool},M=Object(s.connect)(M,T);var V=function(e){function t(){return N(this,t),P(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return x(t,r.a.Component),j(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("pre",{className:"no-overflow"},this.props.backup.sha1," * SHA1"),r.a.createElement("br",null))}}]),t}();V=Object(s.connect)(V,T);t.c=function(){return r.a.createElement(C.a,null,r.a.createElement(O.a,{path:"/wallet/backup/restore",exact:!0,component:B}),r.a.createElement(O.a,{path:"/wallet/backup/create",component:W}),r.a.createElement(O.a,{path:"/wallet/backup/brainkey",component:S.a}))}},347:function(e,t,n){"use strict";var a=n(0),r=n.n(a),l=n(17),o=n(24),s=n.n(o),c=n(34),i=n(3),u=n(4),p=n(42),m=n(40),d=n(248),h=n(30),f=n(54),b=n(268),_=n(1),y=n.n(_),v=n(8),w=n.n(v),E=n(348),g=n(77),k=n(102),C=n(18),O=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var S=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),O(t,[{key:"render",value:function(){if(void 0===this.props.balances)return r.a.createElement("div",null,r.a.createElement(y.a,{content:"wallet.loading_balances"}),"…");var e=this.props.balances.groupBy(function(e){return e.balance.asset_id}).map(function(e){return e.reduce(function(e,t){return e+Number(t.balance.amount)},0)});return e.size?r.a.createElement("div",null,e.map(function(e,t){return r.a.createElement("div",{key:t},r.a.createElement(C.a,{color:"info",amount:e,asset:t}))}).toArray()):r.a.createElement("div",null,"None")}}]),t}(),j=S=Object(l.connect)(S,{listenTo:function(){return[k.a]},getProps:function(){return k.a.getState()}}),N=n(10),P=n(192),x=n(559),T=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(871);var W=function(e){var t=e.key_count;return t?r.a.createElement("span",null,"Found ",t," private keys"):r.a.createElement("span",null)},B=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.showDecordModal=function(){f.a.showModal(b.a)},e.state=e._getInitialState(),e._renderBalanceClaims=e._renderBalanceClaims.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),T(t,[{key:"_getInitialState",value:function(){return{keys_to_account:{},no_file:!0,account_keys:[],reset_file_name:arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.state.reset_file_name:Date.now(),reset_password:Date.now(),password_checksum:null,import_file_message:null,import_password_message:null,imported_keys_public:{},key_text_message:null,genesis_filtering:!1,genesis_filter_status:[],genesis_filter_finished:void 0,importSuccess:!1}}},{key:"reset",value:function(e,t){var n=this;e&&e.preventDefault();var a=this._getInitialState(t);this.setState(a,function(){return n.updateOnChange()})}},{key:"onWif",value:function(e){e.preventDefault();var t=this.refs.wifInput.value;this.addByPattern(t)}},{key:"onCancel",value:function(e){e&&e.preventDefault(),this.setState(this._getInitialState())}},{key:"updateOnChange",value:function(){g.a.setPubkeys(Object.keys(this.state.imported_keys_public))}},{key:"getImportAccountKeyCount",value:function(e){var t={},n=!1;for(var a in e){var r=!0,l=!1,o=void 0;try{for(var s,c=e[a].account_names[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var i=s.value;t[i]=(t[i]||0)+1,n=!0}}catch(e){l=!0,o=e}finally{try{!r&&c.return&&c.return()}finally{if(l)throw o}}}return n?t:null}},{key:"upload",value:function(e){var t=this;this.reset(null,!0);var n=e.target.files[0],a=new FileReader;a.onload=function(e){var a=e.target.result;try{var r=void 0;try{r=JSON.parse(a),t._parseImportKeyUpload(r,n.name,function(e){t.setState(e,function(){e.genesis_filter_finished&&t._passwordCheck()})})}catch(e){try{r||n.name,t._parseWalletJson(r)}catch(e){if(!t.addByPattern(a))throw e}t._passwordCheck()}}catch(e){console.error("... ImportKeys upload error",e),t.setState({import_file_message:e})}},a.readAsText(n)}},{key:"_parseImportKeyUpload",value:function(e,t,n){var a=this,r=void 0,l=void 0;try{if(!(r=e.password_checksum))throw t+" is an unrecognized format";if(!Array.isArray(e.account_keys))throw t+" is an unrecognized format";l=e.account_keys}catch(e){throw e.message||e}var o=new x.a;o.isAvailable()?this.setState({genesis_filter_initalizing:!0},function(){return o.init(function(){var e=a.state.genesis_filter_status,t=l;o.filter(t,function(a){if("missing_public_keys"===a.error)return console.error("un-released format, just for testing"),void n({password_checksum:r,account_keys:l,genesis_filter_finished:!0,genesis_filtering:!1});if(a.success)n({password_checksum:r,account_keys:t,genesis_filter_finished:!0,genesis_filtering:!1});else if(void 0===a.initalizing)if(void 0!==a.importing){if(e.length)e[e.length-1].account_name===a.account_name?e[e.length-1]=a:e.push(a);else e.push(a);n({genesis_filter_status:e})}else console.error("unknown status",a);else n({genesis_filter_initalizing:a.initalizing,genesis_filtering:!0})})})}):n({password_checksum:r,account_keys:l,genesis_filter_finished:!0,genesis_filtering:!1})}},{key:"_parseWalletJson",value:function(e){var t=void 0,n=void 0,a={},r={},l=function(e,t){e=u.b.address_prefix+e.substring(3);var n=i.i.fromPublicKeyString(e).toAddressString(),a=r[t]||[];n="CYB"+n.substring(3),a.push(n),r[t]=a};try{if(!Array.isArray(e))throw new Error("Invalid wallet format");var o=!0,s=!1,c=void 0;try{for(var p,m=e[Symbol.iterator]();!(o=(p=m.next()).done);o=!0){var d=p.value;if("key_record_type"==d.type&&d.data.account_address&&d.data.encrypted_private_key){var h=d.data.account_address,f=a[h]||[];f.push(d.data.encrypted_private_key),a[h]=f}else if("account_record_type"!=d.type)if("property_record_type"!=d.type||"encrypted_brainkey"!=d.data.key){if("master_key_record_type"==d.type){if(!d.data)throw file.name+" invalid master_key_record record";if(!d.data.checksum)throw file.name+" is missing master_key_record checksum";t=d.data.checksum}}else n=d.data.value;else{var b=d.data.name;l(d.data.owner_key,b);var _=!0,y=!1,v=void 0;try{for(var w,E=d.data.active_key_history[Symbol.iterator]();!(_=(w=E.next()).done);_=!0){l(w.value[1],b)}}catch(e){y=!0,v=e}finally{try{!_&&E.return&&E.return()}finally{if(y)throw v}}}}}catch(e){s=!0,c=e}finally{try{!o&&m.return&&m.return()}finally{if(s)throw c}}if(!n)throw"Please use a CYB 1.0 wallet_export_keys file instead";if(!t)throw file.name+" is missing password_checksum";if(!enckeys.length)throw file.name+" does not contain any private keys"}catch(e){throw e.message||e}var g=[];for(var k in r){var C=[],O=!0,S=!1,j=void 0;try{for(var N,P=r[k][Symbol.iterator]();!(O=(N=P.next()).done);O=!0){var x=a[N.value];if(x){var T=!0,W=!1,B=void 0;try{for(var A,I=x[Symbol.iterator]();!(T=(A=I.next()).done);T=!0){var D=A.value;C.push(D)}}catch(e){W=!0,B=e}finally{try{!T&&I.return&&I.return()}finally{if(W)throw B}}}}}catch(e){S=!0,j=e}finally{try{!O&&P.return&&P.return()}finally{if(S)throw j}}g.push({account_name:k,encrypted_private_keys:C})}this.setState({password_checksum:t,account_keys:g})}},{key:"_passwordCheck",value:function(e){var t=this;e&&"preventDefault"in e&&e.preventDefault();var n=this.refs.password,a=n?n.value:"";if(this.state.password_checksum!=i.n.sha512(i.n.sha512(a)).toString("hex"))return this.setState({no_file:!1,import_password_message:a.length?"Incorrect password":null});this.setState({no_file:!1,reset_password:Date.now(),import_password_message:w.a.translate("wallet.import_pass_match")},function(){return t._decryptPrivateKeys(a)})}},{key:"_decryptPrivateKeys",value:function(e){var t=this,n=i.a.fromSeed(e),a=!0,r=!0,l=!1,o=void 0;try{for(var s,p=this.state.account_keys[Symbol.iterator]();!(r=(s=p.next()).done);r=!0){var m=s.value;if(m.encrypted_private_keys)for(var d=m.account_name.trim(),h=new RegExp("^"+u.b.address_prefix),f=0;f<m.encrypted_private_keys.length;f++){var b=m.encrypted_private_keys[f],_=m.public_keys?m.public_keys[f]:null;try{var y=n.decryptHex(b);if(_)h.test(_)||(_=u.b.address_prefix+_.substring(3));else _=i.h.fromHex(y).toPublicKey().toPublicKeyString();this.state.imported_keys_public[_]=!0;var v=(this.state.keys_to_account[y]||{account_names:[]}).account_names,w=!1,E=!0,g=!1,k=void 0;try{for(var C,O=v[Symbol.iterator]();!(E=(C=O.next()).done);E=!0){C.value==d&&(w=!0)}}catch(e){g=!0,k=e}finally{try{!E&&O.return&&O.return()}finally{if(g)throw k}}if(w)continue;v.push(d),this.state.keys_to_account[y]={account_names:v,public_key_string:_}}catch(e){console.log(e,e.stack);var S=e.message||e;c.b.error("Account "+d+" had a private key import error: "+S)}}else{var j="Account "+m.account_name+" missing encrypted_private_keys";console.error(j),a&&(c.b.error(j),a=!1)}}}catch(e){l=!0,o=e}finally{try{!r&&p.return&&p.return()}finally{if(l)throw o}}this.setState({import_file_message:null,import_password_message:null,password_checksum:null},function(){return t.updateOnChange()})}},{key:"_saveImport",value:function(e){var t=this;e.preventDefault();var n=p.a.getState().keys,a={};for(var r in this.state.imported_keys_public)n.has(r)&&(delete this.state.imported_keys_public[r],a[r]=!0);if(0!==Object.keys(this.state.imported_keys_public).length){var l=this.state.keys_to_account,o=!0,s=!1,i=void 0;try{for(var u,d=Object.keys(l)[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var h=u.value,f=l[h];f.account_names;a[f.public_key_string]&&delete l[h]}}catch(e){s=!0,i=e}finally{try{!o&&d.return&&d.return()}finally{if(s)throw i}}m.a.unlock().then(function(){P.a.importing(!0),setTimeout(function(){return t.saveImport()},200)})}else c.b.error("This wallet has already been imported")}},{key:"saveImport",value:function(){var e=this,t=this.state.keys_to_account,n=[],a=!0,r=!1,l=void 0;try{for(var o,s=Object.keys(t)[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var i=o.value,u=t[i],p=u.account_names,m=u.public_key_string;n.push({private_plainhex:i,import_account_names:p,public_key_string:m})}}catch(e){r=!0,l=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw l}}this.reset(),N.a.importKeysWorker(n).then(function(t){P.a.importing(!1);var a=n.length;c.b.success(w.a.translate("wallet.import_key_success",{count:a})),e.setState({importSuccess:!0})}).catch(function(e){console.log("error:",e),P.a.importing(!1);var t=e;try{t=e.target.error.message}catch(e){}c.b.error("Key import error: "+t)})}},{key:"addByPattern",value:function(e){var t=this;if(!e)return!1;var n=0,a=0,r=!0,l=!1,o=void 0;try{for(var s,c=(e.match(/5[HJK][1-9A-Za-z]{49}/g)||[])[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var u=s.value;try{var p=i.h.fromWif(u),m=p.toBuffer().toString("hex"),d=p.toPublicKey().toPublicKeyString();this.state.imported_keys_public[d]=!0,this.state.keys_to_account[m]={account_names:[],public_key_string:d},n++}catch(e){a++}}}catch(e){l=!0,o=e}finally{try{!r&&c.return&&c.return()}finally{if(l)throw o}}return this.setState({key_text_message:"Found "+(n?n+" valid":"")+(a?" and "+a+" invalid":"")+" key"+(n>1||a>1?"s":"")+"."},function(){return t.updateOnChange()}),this.state.key_text_message=null,n}},{key:"_renderBalanceClaims",value:function(){return r.a.createElement("div",null,r.a.createElement(E.a,null),r.a.createElement("div",{style:{paddingTop:15}},r.a.createElement("div",{className:"button success",onClick:this.onCancel.bind(this)},r.a.createElement(y.a,{content:"wallet.done"}))))}},{key:"render",value:function(){var e=this,t=this.props.privateKey,n=this.state.keys_to_account,a=Object.keys(n).length,l=this.getImportAccountKeyCount(n);if(!N.a.getWallet())return r.a.createElement(d.WalletCreate,{importKeys:!0,hideTitle:!0});if(this.props.importing)return r.a.createElement("div",null,r.a.createElement("div",{className:"center-content"},r.a.createElement(h.a,{type:"circle"})));var o=this.state.genesis_filtering,c=(!!this.state.genesis_filter_status.length&&this.state.genesis_filter_finished,null);if(this.state.genesis_filter_status.length){c=[];var i=!0,u=!1,p=void 0;try{for(var m,f=this.state.genesis_filter_status[Symbol.iterator]();!(i=(m=f.next()).done);i=!0){var _=m.value;_.count&&_.total&&c.push(r.a.createElement("tr",{key:_.account_name},r.a.createElement("td",null,_.account_name),r.a.createElement("td",null,o?r.a.createElement("span",null,"Filtering ",Math.round(_.count/_.total*100)," ","%"," "):r.a.createElement("span",null,_.count))))}}catch(e){u=!0,p=e}finally{try{!i&&f.return&&f.return()}finally{if(u)throw p}}}var v=0!==a,E=w.a.translate("wallet.import_password");if(v&&(E=""),!c&&l)for(var g in c=[],l)c.push(r.a.createElement("tr",{key:g},r.a.createElement("td",null,g),r.a.createElement("td",null,l[g])));var k=r.a.createElement("div",{className:"button success",onClick:this.onCancel.bind(this)},r.a.createElement(y.a,{content:"wallet.cancel"})),C=1;return this.state.importSuccess?this._renderBalanceClaims():r.a.createElement("div",null,r.a.createElement("div",{style:{padding:"10px 0"}},r.a.createElement("span",null,this.state.key_text_message?this.state.key_text_message:r.a.createElement(W,{key_count:a})),v?r.a.createElement("span",null," ","(",r.a.createElement("a",{onClick:this.reset.bind(this)},r.a.createElement(y.a,{content:"wallet.reset"})),")"):null),c?r.a.createElement("div",null,c.length?r.a.createElement("div",null,r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,r.a.createElement(y.a,{content:"explorer.account.title"})),r.a.createElement("th",null,r.a.createElement(y.a,{content:"settings.restore_key_count"})))),r.a.createElement("tbody",null,c)),r.a.createElement("br",null)):w.a.translate("wallet.no_accounts")):null,r.a.createElement("br",null),v||this.state.genesis_filter_initalizing?null:r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",null,t?r.a.createElement("form",{onSubmit:this.onWif.bind(this)},r.a.createElement(y.a,{component:"label",content:"wallet.paste_private"}),r.a.createElement("input",{ref:"wifInput",type:"password",id:"wif",tabIndex:C++}),r.a.createElement("div",{className:"form-group"},r.a.createElement(y.a,{component:"a",content:"wallet.has_encrypted",href:"javascript:;",onClick:this.showDecordModal})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"button",type:"submit"},r.a.createElement(y.a,{content:"wallet.submit"})),k),r.a.createElement(b.b,{modalId:b.a})):r.a.createElement("form",{onSubmit:this._passwordCheck.bind(this)},r.a.createElement("label",null,r.a.createElement(y.a,{content:"wallet.cyb_09_export"}),this.state.no_file?null:r.a.createElement("span",null,"  (",r.a.createElement("a",{onClick:this.reset.bind(this)},"Reset"),")")),r.a.createElement("input",{type:"file",id:"file_input",accept:".json",style:{border:"solid",marginBottom:15},key:this.state.reset_file_name,onChange:this.upload.bind(this)}),r.a.createElement("div",null,this.state.import_file_message),this.state.no_file?null:r.a.createElement("div",null,r.a.createElement("input",{type:"password",ref:"password",key:this.state.reset_password,placeholder:E,onChange:function(){e.state.import_password_message&&e.state.import_password_message.length&&e.setState({import_password_message:null})}}),r.a.createElement("p",{className:"facolor-error"},this.state.import_password_message)),r.a.createElement("div",{className:"button-group"},r.a.createElement("button",{className:s()("button",{disabled:!!this.state.no_file}),type:"submit"},r.a.createElement(y.a,{content:"wallet.submit"})),k))),r.a.createElement("br",null),r.a.createElement("br",null))),this.state.genesis_filter_initalizing?r.a.createElement("div",null,r.a.createElement("div",{className:"center-content"},r.a.createElement(h.a,{type:"circle"}))):null,v?r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:"button-group"},r.a.createElement("div",{className:s()("button success",{disabled:!v}),onClick:this._saveImport.bind(this)},r.a.createElement(y.a,{content:"wallet.import_keys"})),r.a.createElement("div",{className:"button secondary",onClick:this.reset.bind(this)},r.a.createElement(y.a,{content:"wallet.cancel"})))),r.a.createElement("h4",null,r.a.createElement(y.a,{content:"wallet.unclaimed"})),r.a.createElement(y.a,{component:"p",content:"wallet.claim_later"}),r.a.createElement("div",{className:"grid-block"},r.a.createElement("div",{className:"grid-content no-overflow"},r.a.createElement(y.a,{component:"label",content:"wallet.totals"}),r.a.createElement(j,null))),r.a.createElement("br",null)):null)}}]),t}();B.defaultProps={privateKey:!0},B=Object(l.connect)(B,{listenTo:function(){return[P.a]},getProps:function(){return{importing:P.a.getState().importing}}});t.a=B},348:function(e,t,n){"use strict";var a=n(0),r=n.n(a),l=n(17),o=n(5),s=n.n(o),c=n(24),i=n.n(c),u=n(34),p=n(30),m=n(42),d=n(117),h=n(102),f=n(77),b=n(18),_=n(1),y=n.n(_),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var w=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),v(t,[{key:"componentWillReceiveProps",value:function(e){e.claim_account_name&&this.onClaimAccount(e.claim_account_name,e.checked)}},{key:"render",value:function(){var e=this;if(void 0===this.props.balances||!this.props.total_by_account_asset.size)return r.a.createElement("div",null);var t=-1;return r.a.createElement("div",null,r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",{style:{textAlign:"center"}},r.a.createElement(y.a,{content:"wallet.unclaimed"})),r.a.createElement("th",{style:{textAlign:"center"}},r.a.createElement(y.a,{content:"wallet.unclaimed_vesting"})),r.a.createElement("th",{style:{textAlign:"center"}},r.a.createElement(y.a,{content:"account.name"})))),r.a.createElement("tbody",null,this.props.total_by_account_asset.map(function(n,a){return r.a.createElement("tr",{key:++t},r.a.createElement("td",null,r.a.createElement("input",{type:"checkbox",checked:!!e.props.checked.get(t),onChange:e.onCheckbox.bind(e,t,n.balances)})),r.a.createElement("td",{style:{textAlign:"right"}},n.unclaimed?r.a.createElement(b.a,{color:"info",amount:n.unclaimed,asset:a.get(1)}):null),r.a.createElement("td",{style:{textAlign:"right"}},n.vesting.unclaimed?r.a.createElement("div",null,r.a.createElement(b.a,{color:"info",amount:n.vesting.unclaimed,hide_asset:!0,asset:a.get(1)}),r.a.createElement("span",null," of "),r.a.createElement(b.a,{color:"info",amount:n.vesting.total,asset:a.get(1)})):null),r.a.createElement("td",null," ",a.get(0)," "))}).toArray())))}},{key:"onCheckbox",value:function(e,t){var n=this.props.checked;n=n.get(e)?n.delete(e):n.set(e,t),f.a.setSelectedBalanceClaims(n)}},{key:"onClaimAccount",value:function(e,t){if(!t.size){var n=-1;this.props.total_by_account_asset.forEach(function(a,r){n++,r.get(0)===e&&(a.unclaimed||a.vesting.unclaimed)&&(t=t.set(n,a.balances))}),t.size&&f.a.setSelectedBalanceClaims(t)}}}]),t}(),E=w=Object(l.connect)(w,{listenTo:function(){return[h.a]},getProps:function(){var e=h.a.getState(),t=e.balances,n=e.address_to_pubkey,a=m.a.getState().keys,r=s.a.Map().asMutable();return t&&(e.total_by_account_asset=t.groupBy(function(e){var t="",l=n.get(e.owner),o=a.get(l);o&&o.import_account_names&&(t=o.import_account_names.join(", "));var c=Math.ceil(function(e,t){var n=r.get(e);return n||(n=s.a.Set().asMutable(),r.set(e,n)),n.add(t),n.size}(s.a.List([t,e.balance.asset_id]),e.owner)/60);return s.a.List([t,e.balance.asset_id,c])}).map(function(e){return e.reduce(function(e,t){return t.public_key_string=n.get(t.owner),e.balances=e.balances.add(t),void 0!=t.vested_balance?(e.vesting.unclaimed+=Number(t.vested_balance.amount),e.vesting.total+=Number(t.balance.amount)):e.unclaimed+=Number(t.balance.amount),e},{unclaimed:0,vesting:{unclaimed:0,total:0},balances:s.a.Set()})}).sortBy(function(e){return e})),e}}),g=n(43),k=n(359),C=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var O=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),C(t,[{key:"componentWillMount",value:function(){var e=m.a.getState().keys.keySeq();f.a.setPubkeys(e),this.existing_keys=e}},{key:"componentWillReceiveProps",value:function(e){var t=m.a.getState().keys.keySeq();t.equals(this.existing_keys)||(this.existing_keys=t,f.a.setPubkeys(t))}},{key:"render",value:function(){if(!this.props.account_refs.size)return r.a.createElement("div",null,r.a.createElement("h5",null,r.a.createElement(y.a,{content:"wallet.no_balance"})));if(this.props.loading)return r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h5",null,r.a.createElement(y.a,{content:"wallet.loading_balances"}),"…"),r.a.createElement("br",null),r.a.createElement(p.a,{type:"three-bounce"}));if(!this.props.balances||!this.props.balances.size)return r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h5",null,r.a.createElement(y.a,{content:"wallet.no_balance"})));var e=this.props.selected_balances.size&&this.props.claim_account_name,t=e?" ("+this.props.claim_account_name+")":null;return r.a.createElement("div",null,r.a.createElement("div",{className:"content-block center-content"},r.a.createElement("h3",{className:"no-border-bottom"},r.a.createElement(y.a,{content:"wallet.claim_balances"}))),r.a.createElement("div",{className:"grid-block vertical"},r.a.createElement("div",{className:"grid-content",style:{overflowY:"hidden !important"}},r.a.createElement("div",{className:"full-width-content center-content"},r.a.createElement(k.a,{key:this.props.balances,accounts:s.a.List(this.props.account_refs),onChange:this.onClaimAccountChange.bind(this)})),r.a.createElement("br",null)),r.a.createElement("br",null),r.a.createElement(E,null)),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:i()("button success",{disabled:!e}),onClick:this.onClaimBalance.bind(this)},r.a.createElement(y.a,{content:"wallet.claim_balance"}),t),r.a.createElement("div",{className:"button cancel",onClick:this.onBack.bind(this)},r.a.createElement(y.a,{content:"wallet.cancel"})))}},{key:"onBack",value:function(e){e.preventDefault(),window.history.back()}},{key:"onClaimAccountChange",value:function(e){f.a.claimAccountChange(e)}},{key:"onClaimBalance",value:function(){g.a.importBalance(this.props.claim_account_name,this.props.selected_balances,!0).catch(function(e){console.error("claimBalance",e);var t=e;try{t=e.data.message}catch(e){}throw u.b.error("Error claiming balance: "+t),e})}}]),t}();O=Object(l.connect)(O,{listenTo:function(){return[h.a,d.a,m.a]},getProps:function(){var e=h.a.getState();return e.account_refs=d.a.getAccountRefs(),e}});t.a=O},357:function(e,t,n){"use strict";var a=n(0),r=n.n(a),l=n(63),o=n(1),s=n.n(o),c=n(43),i=n(10),u=n(3),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var m=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state=e._getInitialState(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),p(t,[{key:"_getInitialState",value:function(){return{password:null,brainkey:null,invalid_password:!1}}},{key:"render",value:function(){var e,t=i.a.getWallet().brainkey_backup_date,n=t?r.a.createElement("div",null,r.a.createElement(s.a,{content:"wallet.brainkey_backed_up"}),": ",r.a.createElement(l.a,{value:t})):r.a.createElement(s.a,{className:"facolor-error",component:"p",content:"wallet.brainkey_not_backed_up"});if(this.state.verified){var a=u.n.sha1(this.state.brainkey).toString("hex").substring(0,4);e=r.a.createElement("div",null,r.a.createElement("h3",null,r.a.createElement(s.a,{content:"wallet.brainkey"})),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-content"},r.a.createElement("h5",null,this.state.brainkey))),r.a.createElement("br",null),r.a.createElement("pre",{className:"no-overflow"},"sha1 hash of the brainkey: ",a),r.a.createElement("br",null),n)}if(!e&&this.state.brainkey){a=u.n.sha1(this.state.brainkey).toString("hex").substring(0,4);e=r.a.createElement("span",null,r.a.createElement("h3",null,r.a.createElement(s.a,{content:"wallet.brainkey"})),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-content"},r.a.createElement("h5",null,this.state.brainkey))),r.a.createElement("div",{style:{padding:"10px 0"}},r.a.createElement("pre",{className:"no-overflow"},"sha1 hash of your brainkey: ",a)),r.a.createElement("hr",null),r.a.createElement("div",{style:{padding:"10px 0 20px 0"}},r.a.createElement(s.a,{content:"wallet.brainkey_w1"}),r.a.createElement("br",null),r.a.createElement(s.a,{content:"wallet.brainkey_w2"}),r.a.createElement("br",null),r.a.createElement(s.a,{content:"wallet.brainkey_w3"})),r.a.createElement("button",{className:"button success",onClick:this.onComplete.bind(this)},r.a.createElement(s.a,{content:"wallet.verify"})),r.a.createElement("button",{className:"button cancel",onClick:this.reset.bind(this)},r.a.createElement(s.a,{content:"wallet.cancel"})))}if(!e){this.state.password&&this.state.password;e=r.a.createElement("span",null,r.a.createElement("label",null,r.a.createElement(s.a,{content:"wallet.enter_password"})),r.a.createElement("form",{onSubmit:this.onSubmit.bind(this),className:"name-form",noValidate:!0},r.a.createElement("input",{type:"password",id:"password",onChange:this.onPassword.bind(this)}),r.a.createElement("p",null,this.state.invalid_password?r.a.createElement("span",{className:"error"},"Invalid password"):r.a.createElement("span",null,r.a.createElement(s.a,{content:"wallet.pwd4brainkey"}))),r.a.createElement("div",null,n,r.a.createElement("br",null)),r.a.createElement("button",{className:"button success"},r.a.createElement(s.a,{content:"wallet.show_brainkey"}))))}return r.a.createElement("div",{className:"grid-block vertical"},r.a.createElement("div",{className:"grid-content no-overflow"},e))}},{key:"onComplete",value:function(e){this.setState({verified:!0}),c.a.setBrainkeyBackupDate()}},{key:"reset",value:function(e){e&&e.preventDefault(),this.setState(this._getInitialState())}},{key:"onBack",value:function(e){e.preventDefault(),window.history.back()}},{key:"onSubmit",value:function(e){e.preventDefault();var t=i.a.isLocked();if(i.a.validatePassword(this.state.password,!0)){var n=i.a.getBrainKey();t&&i.a.onLock(),this.setState({brainkey:n})}else this.setState({invalid_password:!0})}},{key:"onPassword",value:function(e){this.setState({password:e.target.value,invalid_password:!1})}}]),t}();t.a=m},358:function(e,t,n){"use strict";var a=n(0),r=n.n(a),l=n(17),o=n(5),s=n.n(o),c=n(24),i=n.n(c),u=n(254),p=n(267),m=n(23),d=n(21),h=n(257),f=n(29),b=n(1),_=n.n(b),y=n(558),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var k={listenTo:function(){return[p.a.getInstance("wmc")]},getProps:function(){return p.a.getInstance("wmc").getState()}},C=function(e){function t(){return w(this,t),E(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return g(t,r.a.Component),v(t,[{key:"componentWillUnmount",value:function(){p.a.closeInstance("wmc")}},{key:"render",value:function(){return r.a.createElement("span",null,r.a.createElement("h3",null,r.a.createElement(_.a,{content:"wallet.brainkey"})),r.a.createElement(j,null,r.a.createElement(O,null)))}}]),t}();C=Object(l.connect)(C,k),t.a=C;var O=function(e){function t(){return w(this,t),E(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return g(t,r.a.Component),v(t,[{key:"render",value:function(){var e=this.props.brnkey.substring(0,10);return r.a.createElement("span",null,r.a.createElement("div",null,r.a.createElement("span",{className:""},e),"…"),r.a.createElement("p",null),this.props.account_ids.size?r.a.createElement(S,{accounts:s.a.List(this.props.account_ids.toArray())}):r.a.createElement("h5",null,r.a.createElement(_.a,{content:"wallet.no_accounts"})))}}]),t}();O=Object(l.connect)(O,k);var S=function(){function e(){w(this,e)}return v(e,[{key:"render",value:function(){var e=Object(f.pairs)(this.props.accounts).filter(function(e){return!!e[1]}).map(function(e){return e[1].get("name")}).sort().map(function(e){return r.a.createElement(y.a,{key:e,account:e})});return r.a.createElement("span",null,e)}}]),e}();S.propTypes={accounts:d.a.ChainAccountsList.isRequired},S=Object(m.a)(S,{keep_updating:!0});var j=function(e){function t(){w(this,t);var e=E(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={brnkey:"",accept:!1},e}return g(t,r.a.Component),v(t,[{key:"render",value:function(){if(this.state.accept)return r.a.createElement("span",null,this.props.children);var e=this.state.brnkey&&""!==this.state.brnkey;return r.a.createElement("span",{className:"grid-container"},r.a.createElement("div",null,r.a.createElement(h.a,{onChange:this.onBrainkeyChange.bind(this)})),r.a.createElement("div",{className:i()("button success",{disabled:!e}),onClick:this.onAccept.bind(this)},r.a.createElement(_.a,{content:"wallet.accept"})))}},{key:"onBrainkeyChange",value:function(e){this.setState({brnkey:e})}},{key:"onAccept",value:function(){this.setState({accept:!0}),u.a.setBrainkey(this.state.brnkey)}}]),t}()},367:function(e,t,n){"use strict";var a=n(0),r=n(2),l=n(985),o=n(1),s=n.n(o),c=n(34),i=n(24),u=n.n(i),p=n(10),m=n(258),d=n(8),h=n.n(d),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=function(e){function t(){b(this,t);var e=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={success:!1},e}return y(t,a["Component"]),f(t,[{key:"onAccept",value:function(e){var t=this;e.preventDefault();var n=this.state,a=n.old_password,r=n.new_password;p.a.changePassword(a,r,!0).then(function(){c.b.success("Password changed"),t.setState({success:!0})}).catch(function(e){console.error(e),c.b.error("Unable to change password: "+e)})}},{key:"onOldPassword",value:function(e){this.setState({old_password:e})}},{key:"onNewPassword",value:function(e){this.setState({new_password:e})}},{key:"_onCancel",value:function(){this.setState({old_password:""}),this.refs.pwd.cancel()}},{key:"render",value:function(){var e=!!this.state.new_password;return this.state.success?a.createElement("div",null,a.createElement(s.a,{component:"p",content:"wallet.change_success"}),a.createElement(s.a,{component:"p",content:"wallet.change_backup"}),a.createElement(l.a,{to:"/wallet/backup/create"},a.createElement("div",{className:"button outline"},a.createElement(s.a,{content:"wallet.create_backup"})))):a.createElement("span",null,a.createElement(w,{ref:"pwd",onValid:this.onOldPassword.bind(this)},a.createElement(m.a,{onSubmit:this.onAccept.bind(this),newPassword:!0,onValid:this.onNewPassword.bind(this)},a.createElement("button",{className:u()("button outline",{disabled:!e}),type:"submit",onClick:this.onAccept.bind(this)},a.createElement(s.a,{content:"wallet.accept"})),a.createElement("div",{className:"button outline",onClick:this._onCancel.bind(this)},a.createElement(s.a,{content:"wallet.cancel"})))))}}]),t}();t.a=v;var w=function(e){function t(){b(this,t);var e=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={password:"",verified:!1},e}return y(t,a["Component"]),f(t,[{key:"cancel",value:function(){this.setState({verified:!1,password:""})}},{key:"onPassword",value:function(e){e.preventDefault(),p.a.validatePassword(this.state.password)?(this.setState({verified:!0}),this.props.onValid(this.state.password)):c.b.error("Invalid Password")}},{key:"formChange",value:function(e){var t={};t[e.target.id]=e.target.value,this.setState(t)}},{key:"render",value:function(){return this.state.verified?a.createElement("div",{className:"grid-content"},this.props.children):a.createElement("form",{onSubmit:this.onPassword.bind(this)},a.createElement("label",null,a.createElement(s.a,{content:"wallet.existing_password"})),a.createElement("section",null,a.createElement("input",{placeholder:h.a.translate("wallet.current_pass"),type:"password",id:"password",onChange:this.formChange.bind(this),value:this.state.password})),a.createElement("button",{className:"button outline"},a.createElement(s.a,{content:"wallet.submit"})))}}]),t}();w.propTypes={onValid:r.func.isRequired};!function(e){function t(){return b(this,t),_(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}y(t,a["Component"]),f(t,[{key:"render",value:function(){var e=this.props.label||a.createElement(s.a,{content:"wallet.reset"});return a.createElement("span",{className:"button outline",onClick:this.onReset.bind(this)},e)}},{key:"onReset",value:function(){window.history.back()}}])}()},368:function(e,t,n){"use strict";n.r(t),n.d(t,"WalletWrapper",function(){return T}),n.d(t,"WalletManager",function(){return j}),n.d(t,"WalletOptions",function(){return N}),n.d(t,"ChangeActiveWallet",function(){return P}),n.d(t,"WalletDelete",function(){return x});var a=n(0),r=n(985),l=n(17),o=n(43),s=n(65),c=n(44),i=n(1),u=n.n(i),p=n(24),m=n.n(p),d=n(8),h=n.n(d),f=n(367),b=n(347),_=n(358),y=n(248),v=n(343),w=n(1503),E=n(984),g=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var S={listenTo:function(){return[c.a]},getProps:function(){return c.a.getState()}},j=function(e){function t(){return k(this,t),C(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return O(t,a["Component"]),g(t,[{key:"getTitle",value:function(){switch(this.props.location.pathname){case"/wallet/create":return"wallet.create_wallet";case"/wallet/backup/create":return"wallet.create_backup";case"/wallet/backup/restore":return"wallet.restore_backup";case"/wallet/backup/brainkey":return"wallet.backup_brainkey";case"/wallet/delete":return"wallet.delete_wallet";case"/wallet/change-password":return"wallet.change_password";case"/wallet/import-keys":return"wallet.import_keys";default:return"wallet.console"}}},{key:"render",value:function(){return a.createElement("div",{className:"grid-block vertical"},a.createElement("div",{className:"grid-container",style:{maxWidth:"40rem"}},a.createElement("div",{className:"content-block center-content"},a.createElement("div",{className:"page-header"},a.createElement(u.a,{component:"h3",content:this.getTitle()})),a.createElement("div",{className:"content-block"},this.props.children))))}}]),t}();j=Object(l.connect)(j,S);var N=function(e){function t(){return k(this,t),C(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return O(t,a["Component"]),g(t,[{key:"render",value:function(){var e=!!this.props.current_wallet,t=this.props.wallet_names.size>1,n=this.props.current_wallet?this.props.current_wallet.toUpperCase():"";return a.createElement("span",null,a.createElement("div",{className:"grid-block"},a.createElement("div",{className:"grid-content"},a.createElement("div",{className:"card"},a.createElement("div",{className:"card-content"},a.createElement("label",null,a.createElement(u.a,{content:"wallet.active_wallet"}),":"),a.createElement("div",null,n),a.createElement("br",null),t?a.createElement(r.a,{to:"/wallet/change"},a.createElement("div",{className:"button outline success"},a.createElement(u.a,{content:"wallet.change_wallet"}))):null))),a.createElement("div",{className:"grid-content"},a.createElement("div",{className:"card"},a.createElement("div",{className:"card-content"},a.createElement("label",null,a.createElement(u.a,{content:"wallet.import_keys_tool"})),a.createElement("div",{style:{visibility:"hidden"}},"Dummy"),a.createElement("br",null),e?a.createElement(r.a,{to:"/wallet/import-keys"},a.createElement("div",{className:"button outline success"},a.createElement(u.a,{content:"wallet.import_keys"}))):null))),e?a.createElement("div",{className:"grid-content"},a.createElement("div",{className:"card"},a.createElement("div",{className:"card-content"},a.createElement("label",null,a.createElement(u.a,{content:"wallet.balance_claims"})),a.createElement("div",{style:{visibility:"hidden"}},"Dummy"),a.createElement("br",null),a.createElement(r.a,{to:"wallet/balance-claims"},a.createElement("div",{className:"button outline success"},a.createElement(u.a,{content:"wallet.balance_claim_lookup"})))))):null),e?a.createElement(r.a,{to:"wallet/backup/create"},a.createElement("div",{className:"button outline success"},a.createElement(u.a,{content:"wallet.create_backup"}))):null,e?a.createElement(r.a,{to:"wallet/backup/brainkey"},a.createElement("div",{className:"button outline success"},a.createElement(u.a,{content:"wallet.backup_brainkey"}))):null,a.createElement(r.a,{to:"wallet/backup/restore"},a.createElement("div",{className:"button outline success"},a.createElement(u.a,{content:"wallet.restore_backup"}))),a.createElement("br",null),e?a.createElement("br",null):null,a.createElement(r.a,{to:"wallet/create"},a.createElement("div",{className:"button outline success"},a.createElement(u.a,{content:"wallet.new_wallet"}))),e?a.createElement(r.a,{to:"wallet/delete"},a.createElement("div",{className:"button outline success"},a.createElement(u.a,{content:"wallet.delete_wallet"}))):null,e?a.createElement(r.a,{to:"wallet/change-password"},a.createElement("div",{className:"button outline success"},a.createElement(u.a,{content:"wallet.change_password"}))):null)}}]),t}();N=Object(l.connect)(N,S);var P=function(e){function t(){k(this,t);var e=C(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={},e}return O(t,a["Component"]),g(t,[{key:"componentWillMount",value:function(){var e=this.props.current_wallet;this.setState({current_wallet:e})}},{key:"componentWillReceiveProps",value:function(e){e.current_wallet!==this.state.current_wallet&&this.setState({current_wallet:e.current_wallet})}},{key:"render",value:function(){var e=c.a.getState(),t=[];e.wallet_names.forEach(function(e){t.push(a.createElement("option",{key:e,value:e},e.toLowerCase()))});var n=this.state.current_wallet!==this.props.current_wallet;return a.createElement("div",null,a.createElement("section",{className:"block-list"},a.createElement("header",null,a.createElement(u.a,{content:"wallet.active_wallet"}),":"),a.createElement("ul",null,a.createElement("li",{className:"with-dropdown"},e.wallet_names.count()<=1?a.createElement("div",{style:{paddingLeft:10}},this.state.current_wallet):a.createElement("select",{value:this.state.current_wallet,onChange:this.onChange.bind(this)},t)))),a.createElement(r.a,{to:"wallet/create"},a.createElement("div",{className:"button outline"},a.createElement(u.a,{content:"wallet.new_wallet"}))),n?a.createElement("div",{className:"button outline",onClick:this.onConfirm.bind(this)},a.createElement(u.a,{content:"wallet.change",name:this.state.current_wallet})):null)}},{key:"onConfirm",value:function(){o.a.setWallet(this.state.current_wallet),s.c.reset()}},{key:"onChange",value:function(e){var t=e.target.value;this.setState({current_wallet:t})}}]),t}();P=Object(l.connect)(P,S);var x=function(e){function t(){k(this,t);var e=C(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={selected_wallet:null,confirm:0},e}return O(t,a["Component"]),g(t,[{key:"_onCancel",value:function(){this.setState({confirm:0,selected_wallet:null})}},{key:"render",value:function(){if(1===this.state.confirm)return a.createElement("div",{style:{paddingTop:20}},a.createElement("h4",null,a.createElement(u.a,{content:"wallet.delete_confirm_line1"})),a.createElement(u.a,{component:"p",content:"wallet.delete_confirm_line3"}),a.createElement("br",null),a.createElement("div",{className:"button outline",onClick:this.onConfirm2.bind(this)},a.createElement(u.a,{content:"wallet.delete_confirm_line4",name:this.state.selected_wallet})),a.createElement("div",{className:"button outline",onClick:this._onCancel.bind(this)},a.createElement(u.a,{content:"wallet.cancel"})));var e=[];e.push(a.createElement("option",{key:"select_option",value:""},h.a.translate("settings.delete_select"),"…")),this.props.wallet_names.forEach(function(t){e.push(a.createElement("option",{key:t,value:t},t.toLowerCase()))});var t=!!this.state.selected_wallet;return a.createElement("div",{style:{paddingTop:20}},a.createElement("section",{className:"block-list"},a.createElement("header",null,a.createElement(u.a,{content:"wallet.delete_wallet"})),a.createElement("ul",null,a.createElement("li",{className:"with-dropdown"},a.createElement("select",{value:this.state.selected_wallet||"",style:{margin:"0 auto"},onChange:this.onChange.bind(this)},e)))),a.createElement("div",{className:m()("button outline",{disabled:!t}),onClick:this.onConfirm.bind(this)},a.createElement(u.a,{content:this.state.selected_wallet?"wallet.delete_wallet_name":"wallet.delete_wallet",name:this.state.selected_wallet})))}},{key:"onConfirm",value:function(){this.setState({confirm:1})}},{key:"onConfirm2",value:function(){o.a.deleteWallet(this.state.selected_wallet),this.props.afterDelete&&this.props.afterDelete(this.state.selected_wallet),this._onCancel()}},{key:"onChange",value:function(e){var t=e.target.value;this.setState({selected_wallet:t})}}]),t}();x=Object(l.connect)(x,S);var T=function(){return a.createElement("div",{style:{margin:"1em auto"}},a.createElement(w.a,null,a.createElement(E.a,{path:"/wallet/",exact:!0,component:N}),a.createElement(E.a,{path:"/wallet/change",component:P}),a.createElement(E.a,{path:"/wallet/change-password",component:f.a}),a.createElement(E.a,{path:"/wallet/import-keys",component:b.a}),a.createElement(E.a,{path:"/wallet/brainkey",component:_.a}),a.createElement(E.a,{path:"/wallet/create",component:y.WalletCreate}),a.createElement(E.a,{path:"/wallet/delete",component:x}),a.createElement(E.a,{path:"/wallet/backup",component:v.c})))};t.default=T},551:function(e,t,n){"use strict";var a=n(0),r=n(2),l=n(89),o=n(121),s=n(37),c=n.n(s),i=n(271),u=n(57),p=n(34),m=n(1),d=n.n(m),h=n(8),f=n.n(h),b=n(136),_=n.n(b),y=n(10),v=n(72),w=n(26),E=n(40),g=n(66),k=n(20),C=n(4),O=n(7),S=n(336),j=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var T=n(600),W=function(e){function t(e){N(this,t);var n=P(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.state=n._getInitialState(e),n.onPasswordEnter=n.onPasswordEnter.bind(n),n}return x(t,a["Component"]),j(t,[{key:"_getInitialState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return{password_error:null,password_input_reset:Date.now(),account_name:e.passwordAccount,account:null}}},{key:"reset",value:function(){this.setState(this._getInitialState())}},{key:"componentWillReceiveProps",value:function(e){e.passwordAccount&&!this.state.account_name&&this.setState({account_name:e.passwordAccount}),e.resolve!=this.props.resolve&&(console.debug("WillReceive",e),this.refs.password_input.clear())}},{key:"shouldComponentUpdate",value:function(e,t){return!O.a.are_equal_shallow(e,this.props)||!O.a.are_equal_shallow(t,this.state)}},{key:"componentDidMount",value:function(){var e=this;c.a.subscribe(this.props.modalId,function(t,n){if(t===e.props.modalId)if("close"===n)e.refs.password_input.clear(),E.a.cancel();else if("open"===n&&!e.props.passwordLogin&&(e.refs.password_input&&(e.refs.password_input.focus(),e.refs.password_input.clear()),y.a.getWallet()&&C.a.instance().chain_id!==y.a.getWallet().chain_id))return p.b.error("This wallet was intended for a different block-chain; expecting "+y.a.getWallet().chain_id.substring(0,4).toUpperCase()+", but got "+C.a.instance().chain_id.substring(0,4).toUpperCase()),void c.a.publish(e.props.modalId,"close")}),this.props.passwordLogin&&(this.state.account_name?this.refs.password_input.focus():this.refs.account_input&&this.refs.account_input.refs.bound_component)}},{key:"componentDidUpdate",value:function(){this.props.resolve&&(y.a.isLocked()?c.a.publish(this.props.modalId,"open"):this.props.resolve())}},{key:"onPasswordEnter",value:function(e){var t=this.props.passwordLogin;e.preventDefault(),console.debug("This Ref: ",this);var n=this.refs.password_input.value(),a=t?this.state.account&&this.state.account.get("name"):null;return this.setState({password_error:null}),y.a.validatePassword(n||"",!0,a),y.a.isLocked()?(this.setState({password_error:!0}),!1):(this.refs.password_input.clear(),g.a.setPasswordAccount(a),c.a.publish(this.props.modalId,"close"),this.props.resolve(),E.a.change(),this.setState({password_input_reset:Date.now(),password_error:!1}),!1)}},{key:"_toggleLoginType",value:function(){k.a.changeSetting({setting:"passwordLogin",value:!this.props.passwordLogin})}},{key:"_onCreateWallet",value:function(){c.a.publish(this.props.modalId,"close"),this.context.router.history.push("/create-account/wallet")}},{key:"renderWalletLogin",value:function(){return y.a.getWallet()?a.createElement("form",{className:"full-width",onSubmit:this.onPasswordEnter,noValidate:!0,style:{paddingTop:20,margin:"0 3.5rem "}},a.createElement(i.a,{ref:"password_input",onEnter:this.onPasswordEnter,key:this.state.password_input_reset,wrongPassword:this.state.password_error,noValidation:!0}),a.createElement("div",null,a.createElement("div",{className:"button-group"},a.createElement("button",{className:"button","data-place":"bottom","data-html":!0,"data-tip":f.a.translate("tooltip.login"),onClick:this.onPasswordEnter},a.createElement(d.a,{content:"header.unlock_short"})),a.createElement(l.a,{close:this.props.modalId},a.createElement("div",{className:" button"},a.createElement(d.a,{content:"account.perm.cancel"})))))):a.createElement("div",null,a.createElement(d.a,{content:"wallet.no_wallet",component:"p"}),a.createElement("div",{className:"button-group"},a.createElement("div",{className:"button",onClick:this._onCreateWallet.bind(this)},a.createElement(d.a,{content:"wallet.create_wallet"}))))}},{key:"accountChanged",value:function(e){e||this.setState({account:null}),this.setState({account_name:e,error:null})}},{key:"onAccountChanged",value:function(e){this.setState({account:e,error:null})}},{key:"renderPasswordLogin",value:function(){var e=this.state,t=e.account_name,n=e.from_error,r=1;return a.createElement("form",{onSubmit:this.onPasswordEnter,noValidate:!0,style:{paddingTop:20}},a.createElement("input",{type:"text",className:"no-padding no-margin",style:{visibility:"hidden",height:0}}),a.createElement("div",{className:"form-wrapper",style:{marginRight:"3.5rem"}},a.createElement("div",{className:"content-block"},a.createElement(S.a,{label:"account.name",ref:"account_input",accountName:t,onChange:this.accountChanged.bind(this),onAccountChanged:this.onAccountChanged.bind(this),account:t,size:60,styleSize:"normal",error:n,tabIndex:r++})),a.createElement("div",{className:"content-block"},a.createElement("div",{className:"account-selector"},a.createElement("div",{className:"content-area"},a.createElement("div",{className:"header-area"},a.createElement("label",{className:"left-label"},a.createElement(d.a,{content:"settings.password"}))),a.createElement("div",{className:"input-area",style:{marginLeft:"3.5rem"}},a.createElement(i.a,{ref:"password_input",name:"password",id:"password",wrongPassword:this.state.password_error,noValidation:!0,noLabel:!0,checkStrength:!0,showStrengthTip:!0,isSimple:!0})))))),a.createElement("div",{className:"grid-block shrink"},a.createElement("div",{className:"grid-block full-width-content",style:{alignItems:"center"}},a.createElement(u.g,{type:"primary",onClick:this.onPasswordEnter},a.createElement(d.a,{content:"header.unlock"})),a.createElement(l.a,{close:this.props.modalId},a.createElement(u.g,{type:"secondary",onClick:this.onPasswordEnter},a.createElement(d.a,{content:"account.perm.cancel"}))))))}},{key:"render",value:function(){var e=this.props.passwordLogin;return a.createElement(o.a,{id:this.props.modalId,ref:"modal",overlay:!0,overlayClose:!1},a.createElement("div",{className:"text-center"},a.createElement("img",{src:T}),a.createElement("div",{style:{marginTop:"1rem"}},a.createElement(d.a,{component:"h4",content:"header.unlock"+(e?"_password":"")}))),e?this.renderPasswordLogin():this.renderWalletLogin())}}]),t}();W.contextTypes={router:r.object},W.defaultProps={modalId:"unlock_wallet_modal2"};var B=function(e){function t(){return N(this,t),P(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return x(t,a["Component"]),j(t,[{key:"render",value:function(){return a.createElement(_.a,{stores:[v.a,w.a],inject:{resolve:function(){return v.a.getState().resolve},reject:function(){return v.a.getState().reject},locked:function(){return v.a.getState().locked},passwordLogin:function(){return v.a.getState().passwordLogin},passwordAccount:function(){return w.a.getState().passwordAccount||""}}},a.createElement(W,this.props))}}]),t}();t.a=B},871:function(e,t,n){}}]);