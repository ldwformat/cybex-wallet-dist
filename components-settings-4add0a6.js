(window.webpackJsonp=window.webpackJsonp||[]).push([[273],{232:function(e,t,n){"use strict";var o=n(0),a=(n(2),n(1)),r=n.n(a),i=n(87),s=n(117),l=n(37),c=n.n(l),u=n(19),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var m="wss://",p=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),n=window.location.protocol;return e.state={protocol:n,ws:m,name:"My node",type:"remove",remove:{},addError:null},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["Component"]),d(t,[{key:"onServerInput",value:function(e){var t={ws:e.target.value};0!==t.ws.indexOf(m)&&0!==t.ws.indexOf("ws://")?t.addError=!0:t.addError=null,this.setState(t)}},{key:"onNameInput",value:function(e){this.setState({name:e.target.value})}},{key:"show",value:function(e,t,n){var o={};-1!==e.target.id.indexOf("add")?o.type="add":-1!==e.target.id.indexOf("remove")&&(o.type="remove",o.remove={url:t,name:n}),this.setState(o),c.a.publish("ws_modal_"+o.type,"open")}},{key:"close",value:function(){c.a.publish("ws_modal_"+this.state.type,"close")}},{key:"onAddSubmit",value:function(e){e.preventDefault(),u.a.addWS({location:this.state.name,url:this.state.ws}),this.setState({ws:"https:"===this.state.protocol?m:"ws://",name:""}),this.close()}},{key:"onRemoveSubmit",value:function(e){var t=this;e.preventDefault();var n=void 0;this.props.apis.forEach(function(e,o){e.url===t.state.remove.url&&(n=o)}),this.props.api===this.props.apis[n].url&&(u.a.changeSetting.defer({setting:"apiServer",value:this.props.apis[0].url}),this.props.changeConnection(this.props.apis[0].url)),u.a.removeWS(n),this.close()}},{key:"_renderAddModal",value:function(){var e={padding:0,color:"white"};return o.createElement(s.a,{id:"ws_modal_add",ref:"ws_modal_add",overlay:!0,overlayClose:!1},o.createElement("div",{className:"grid-content"},o.createElement(r.a,{component:"h3",content:"settings.add_ws"}),o.createElement("form",{onSubmit:this.onAddSubmit.bind(this),noValidate:!0},o.createElement("div",{className:"form-field",style:{marginBottom:"1em"}},o.createElement("label",{htmlFor:"ws_name",style:e},"Name"),o.createElement("input",{id:"ws_name",type:"text",onChange:this.onNameInput.bind(this),value:this.state.name})),o.createElement("div",{className:"form-field"},o.createElement("label",{htmlFor:"ws_address",style:e},"Address"),o.createElement("input",{id:"ws_address",type:"text",onChange:this.onServerInput.bind(this),defaultValue:this.state.ws})),this.state.addError&&o.createElement("p",{style:{marginBottom:"1em"}},o.createElement(r.a,{content:"settings.valid_node_url"})),o.createElement("div",{className:"button-group"},o.createElement("button",{type:"submit",className:"button "+(this.state.addError?"disabled":""),onClick:this.onAddSubmit.bind(this),disabled:this.state.addError},o.createElement(r.a,{content:"transfer.confirm"})),o.createElement(i.a,{close:"ws_modal_add"},o.createElement("div",{className:" button"},o.createElement(r.a,{content:"account.perm.cancel"})))))))}},{key:"_renderRemoveModal",value:function(){return this.props.api?o.createElement(s.a,{id:"ws_modal_remove",ref:"ws_modal_remove",overlay:!0,overlayClose:!1},o.createElement("div",{className:"grid-content no-overflow"},o.createElement(r.a,{component:"h3",content:"settings.remove_ws"}),o.createElement("section",{className:"block-list"},o.createElement("p",null,o.createElement(r.a,{component:"span",content:"settings.confirm_remove",with:{name:this.state.remove.name}}))),o.createElement("form",{onSubmit:this.onRemoveSubmit.bind(this),noValidate:!0},o.createElement("div",{className:"button-group"},o.createElement("button",{type:"submit",className:"button",onClick:this.onRemoveSubmit.bind(this)},o.createElement(r.a,{content:"transfer.confirm"})),o.createElement(i.a,{close:"ws_modal_remove"},o.createElement("div",{className:"button"},o.createElement(r.a,{content:"account.perm.cancel"}))))))):null}},{key:"render",value:function(){return o.createElement("div",null,this._renderAddModal(),this._renderRemoveModal())}}]),t}();t.a=p},424:function(e,t,n){"use strict";var o=n(0),a=(n(2),n(1)),r=n.n(a),i=n(19),s=n(9),l=n(99),c=n(181),u=n(1350),d=n(17),m=n(4),p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g="wss://fake.automatic-selection.com",E=l.d.WS_NODE_LIST.find(function(e){return-1!==e.url.indexOf("121.40")})||{},w=function(e){function t(e){h(this,t);var n=b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={hovered:!1},n}return y(t,o["Component"]),f(t,[{key:"setHovered",value:function(){this.setState({hovered:!0})}},{key:"clearHovered",value:function(){this.setState({hovered:!1})}},{key:"activate",value:function(e){i.a.changeSetting({setting:"apiServer",value:e}),s.b.getSetting("activeNode")!=s.b.getSetting("apiServer")&&setTimeout(function(){Object(c.a)(!1)}.bind(this),50)}},{key:"remove",value:function(e,t,n){this.props.triggerModal(n,e,t)}},{key:"render",value:function(){var e=this.props,t=this.state,n=e.allowActivation,a=e.allowRemoval,i=e.automatic,s=e.autoActive,l=e.name,c=e.url,u=e.displayUrl,d=e.ping,m=e.up,p=void 0,v=void 0;d<400?(p="#00FF00",v="low_latency"):d>=400&&d<800?(p="yellow",v="medium_latency"):(p="red",v="high_latency");var f=c===E.url,h=f&&!d?null:o.createElement("div",{className:"api-status"},o.createElement(r.a,{style:{color:m?"#00FF00":"red",marginBottom:0},component:"h3",content:"settings."+(m?"node_up":"node_down")}),m&&o.createElement(r.a,{content:"settings."+v,style:{color:p}}),!m&&o.createElement("span",{style:{color:"red"}},"__"));return o.createElement("div",{className:"api-node card",onMouseEnter:this.setHovered.bind(this),onMouseLeave:this.clearHovered.bind(this)},o.createElement("h3",{style:{marginBottom:0,marginTop:0}},l),o.createElement("p",{style:{marginBottom:0}},u),i&&s&&o.createElement("div",{className:"api-status"},o.createElement(r.a,{content:"account.votes.active_short",component:"h3"})),!n&&!a&&!i&&h,n&&!i&&!t.hovered&&h,a&&t.hovered&&!(i&&s)&&o.createElement("div",{className:"button",onClick:this.remove.bind(this,c,l)},o.createElement(r.a,{id:"remove",content:"settings.remove"})),n&&t.hovered&&!(i&&s)&&o.createElement("div",{className:"button",onClick:this.activate.bind(this,c)},o.createElement(r.a,{content:"settings.activate"})))}}]),t}();w.defaultProps={name:"Test node",url:"wss://testnode.net/wss",displayUrl:"wss://testnode.net/wss",up:!0,ping:null,allowActivation:!1,allowRemoval:!1};var _=Object(u.a)(w),N=function(e){function t(e){h(this,t);var n=b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),o={};return l.d.WS_NODE_LIST.forEach(function(e){o[e.url]=!0}),n.isDefaultNode=o,n.chain=m.b.address_prefix,n}return y(t,o["Component"]),f(t,[{key:"getNodeIndexByURL",value:function(e){for(var t=this.props,n=null,o=0;o<t.nodes.length;o++){if(t.nodes[o].url==e){n=o;break}}return n}},{key:"getCurrentNodeIndex",value:function(){var e=this.props;return this.getNodeIndexByURL.call(this,e.currentNode)}},{key:"getNode",value:function(e){var t=this.props;return{name:e.location||"Unknown location",url:e.url,up:e.url in t.apiLatencies,ping:t.apiLatencies[e.url]}}},{key:"setPrefix",value:function(){var e=document.getElementById("setPrefix");if(e&&e.value){var t=e.value,n="PREFIX_"+m.a.instance().chain_id;localStorage&&localStorage.setItem(n,t),location.reload()}}},{key:"renderNode",value:function(e,t){var n=this.props,a=e.url===g,i=a?"...":e.url,s=e.name&&"object"===v(e.name)&&"translate"in e.name?o.createElement(r.a,{component:"span",content:e.name.translate}):e.name,l=!a&&!this.isDefaultNode[e.url];return o.createElement(_,p({},e,{autoActive:n.currentNode===g,automatic:a,allowActivation:t,allowRemoval:t&&l,key:e.url,name:s,displayUrl:i,triggerModal:n.triggerModal}))}},{key:"render",value:function(){var e=this.props,t=this.getNode.bind(this),n=this.renderNode.bind(this),a=this.getCurrentNodeIndex.call(this),i=e.nodes.map(function(e){return t(e)}),s=t(e.nodes[a]||e.nodes[0]);if(s.url==g){var l=e.activeNode;a=this.getNodeIndexByURL.call(this,l),s=t(e.nodes[a])}return i=i.filter(function(e,t){return t!==a&&e.url}).sort(function(e,t){var n=e.url===E.url;return e.url==g?-1:e.up&&t.up?e.ping-t.ping:e.up||t.up?e.up&&!t.up?-1:t.up&&!e.up?1:0:n?-1:1}),o.createElement("div",{className:"nodes-wrapper",style:{paddingTop:"1em"}},o.createElement(r.a,{component:"p",content:"settings.active_node"}),o.createElement("div",{className:"active-node"},n(s,!1)),o.createElement("div",{className:"available-nodes"},o.createElement(r.a,{component:"p",content:"settings.available_nodes"}),i.map(function(e){return n(e,!0)})),o.createElement("div",{className:"button-wrapper"},o.createElement(r.a,{id:"add",onClick:e.triggerModal.bind(this),component:"button",className:"button",content:"settings.add_api"})))}}]),t}();N=Object(d.connect)(N,{listenTo:function(){return[s.b]},getProps:function(){return{currentNode:s.b.getState().settings.get("apiServer"),activeNode:s.b.getState().settings.get("activeNode"),apiLatencies:s.b.getState().apiLatencies}}}),t.a=N}}]);